name: cd
on:
  push:
    branches: [ develop ]

jobs:
  cd-test: 
    runs-on: ubuntu-latest 
    steps: 
    - name: check out git repository
      uses: actions/checkout@v4  

    - name: dir list
      run: ls src/main/resources -al
      
    - name: Set up JDK 11 
      uses: actions/setup-java@v4
      with:
        java-version: 11 
        distribution: 'temurin'
        
    - name: Grant execute permission for gradlew
      run: chmod +x gradlew
      
    - name: Test with Gradle
      run: ./gradlew test
      
    ## create application-dev.yml
    - name: make application-dev.yml
      run: |
        # create application-dev.yml
        cd src/main/resources
        
        # application-dev.yml 파일 생성
        touch ./application-dev.yml

        ls -al 

        # GitHub-Actions 에서 설정한 값을 application-dev.yml 파일에 쓰기
        echo "${{ secrets.APPLICATION_DEV_YAML }}" | base64 --decode > ./application-dev.yml

        cat application-dev.yml

    - name: is application-dev.yml
      run: ls src/main/resources
